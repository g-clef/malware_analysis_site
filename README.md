# malware_analysis_site
Site to collect metadata on archives containing malware


## Design

This is a web interface to accept jobs from the various sources. The jobs will consist of file paths to zip 
files to be processed and the password to open the zipfile (if necessary). 

check if entry for this zipfile already exists in archiver (previous processing may have failed)
if so, use that entry for further work, otherwise make new entry in archiver for the zipfile

for each file in the zipfile it will:
    check if a File entry for this file already exists in the archiver (again, processing may have failed)
    if so, use it for future work, otherwise make one here
    if metadata entry doesn't already exist for the file:
        get metadata for file (md5, sha1, sha256, ssdeep)
        submit metadata entry to archiver.
    if it's an executable:
        if header entry doesn't already exist for the file:
            get header information about it (ImpHash, CompileTime, Lief info)
            submit header entry to archiver
        if VT info doesn't already exist for file:
            Look it up in VirusTotal, get VT results
            submit VT info to entry to archiver.


Note: you will need to install the binary SSDeep libraries before installing the python ssdeep library. On
OSX this is `brew install ssdeep`

# SETUP

this relies also on a postgres DB, often the same db server that's used by the archiver. You will need to create at 
least a new db, if not a new user and db. Once that exists, you'll need to hand that username and db path to the 
secrets for this app. After the first time you run the pod, do:
    shell into pod
    `python3 manage.py migrate`
    `python3 manage.py createsuperuser`
    `python3 manage.py collectstatic`
    `python3 manage.py add_user <username for clients>`
    
The last step you'll need to take for each separate user you want to create to write data to the analysis system.
If you want to separate out each data source into separate users, then you'll need to run `add_user` for each source,
and note the username and token for each one. 